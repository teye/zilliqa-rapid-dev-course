<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<title data-react-helmet="true">Events &amp; Errors | TLDR Zilliqa DApp Course</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://teye.github.io/zilliqa-tldr-dapp-course/docs/scilla/events_errors"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Events &amp; Errors | TLDR Zilliqa DApp Course"><meta data-react-helmet="true" name="description" content="In some of the eariler topics, we already saw some events outputs. In this section, we are going to introduce Scilla events and how to throw errors exception in greater details."><meta data-react-helmet="true" property="og:description" content="In some of the eariler topics, we already saw some events outputs. In this section, we are going to introduce Scilla events and how to throw errors exception in greater details."><link data-react-helmet="true" rel="shortcut icon" href="/zilliqa-tldr-dapp-course/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://teye.github.io/zilliqa-tldr-dapp-course/docs/scilla/events_errors"><link data-react-helmet="true" rel="alternate" href="https://teye.github.io/zilliqa-tldr-dapp-course/docs/scilla/events_errors" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://teye.github.io/zilliqa-tldr-dapp-course/docs/scilla/events_errors" hreflang="x-default"><link rel="stylesheet" href="/zilliqa-tldr-dapp-course/assets/css/styles.a2a31263.css">
<link rel="preload" href="/zilliqa-tldr-dapp-course/assets/js/runtime~main.9a777267.js" as="script">
<link rel="preload" href="/zilliqa-tldr-dapp-course/assets/js/main.d6dfde11.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://teye.github.io/zilliqa-tldr-dapp-course/" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/zilliqa-tldr-dapp-course/img/hexagon.svg" alt="Site Logo" class="themedImage_TMUO themedImage--light_4Vu1" height="32" width="32"><img src="/zilliqa-tldr-dapp-course/img/hexagon_light.svg" alt="Site Logo" class="themedImage_TMUO themedImage--dark_uzRr" height="32" width="32"></div><b class="navbar__title">Home</b></a><a class="navbar__item navbar__link navbar__link--active" href="/zilliqa-tldr-dapp-course/docs/intro">Developing DApp on Zilliqa</a></div><div class="navbar__items navbar__items--right"><div class="toggle_iYfV toggle_2i4l toggleChecked_a04y toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" checked="" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Start Here</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Chapter 1: Sciila</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zilliqa-tldr-dapp-course/docs/scilla/intro">Scilla Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zilliqa-tldr-dapp-course/docs/scilla/transitions_procedures">Transitions &amp; Procedures</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zilliqa-tldr-dapp-course/docs/scilla/maps">Maps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zilliqa-tldr-dapp-course/docs/scilla/events_errors">Events &amp; Errors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zilliqa-tldr-dapp-course/docs/scilla/custom_adts">Custom ADT(s)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zilliqa-tldr-dapp-course/docs/scilla/remote_state_reads">Remote State Reads</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Chapter 2: Zilliqa API &amp; ZilliqaJS</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Chapter 3: React DApp Development</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Events &amp; Errors</h1></header><p>In some of the eariler topics, we already saw some events outputs. In this section, we are going to introduce Scilla events and how to throw errors exception in greater details.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="events">Events<a aria-hidden="true" class="hash-link" href="#events" title="Direct link to heading">â€‹</a></h2><p>A Scilla event is an output of a function call. Normally, we used it to output mutable field values after updating them. Scilla events can be read from the blockchain transaction receipt.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="syntax">Syntax<a aria-hidden="true" class="hash-link" href="#syntax" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  transition transitionName()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    e = {_eventname: &quot;EventName&quot;; field: &quot;your_msg&quot;}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    event e</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>To output events, we first declare an <code>e</code> object and use the <code>_eventname</code> keyword. Next, we need to give this event a name and also add the contents that will be output. Finally, we emit the event by calling <code>event e</code>.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="example">Example<a aria-hidden="true" class="hash-link" href="#example" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  transition demoA()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   e = {_eventname: &quot;demoA&quot;; msg: &quot;hello, I am a Scilla event&quot;};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   event e</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  transition demoB(input: Uint128)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    e = {_eventname: &quot;demoB&quot;; num: input}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    event e  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Above are some examples how events can be used. An event can output any types as long as the types are valid. For instance in <code>demoB</code>, we can output a <code>Uint128</code> supplied by the user.</p><p>To view the events output, we can view the transaction state on blockchain explorer such as <a href="https://devex.zilliqa.com" target="_blank" rel="noopener noreferrer"><strong>Devex Zilliqa</strong></a> and <a href="https://viewblock.io/zilliqa" target="_blank" rel="noopener noreferrer"><strong>ViewBlock</strong></a>.</p><p>An example of invoking the transition <code>demoB</code> looks like this on Devex Zilliqa under &quot;Event Logs&quot; section:</p><p><img alt="Devex Zilliqa Emit Event" src="/zilliqa-tldr-dapp-course/assets/images/events-cdbc7b0627c67069a0b2b93e4ffdad72.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="errors">Errors<a aria-hidden="true" class="hash-link" href="#errors" title="Direct link to heading">â€‹</a></h2><p>In Scilla, learning how to throw errors is also essential to contract writing. Frequently, we would have some checks and depending on the result of the checks, we would proceed to do something or throw an error to halt the contract execution.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="syntax-1">Syntax<a aria-hidden="true" class="hash-link" href="#syntax-1" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">scilla_version 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">library DemoError</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(* Error events *)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">type Error =</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| CodeNotOwner</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| CodeNotFound</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| CodeAlreadyExists</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(* Library function that maps Error to a error code *)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">let make_error =</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  fun (result : Error) =&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    let result_code =</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      match result with</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      | CodeNotOwner       =&gt; Int32 -1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      | CodeNotFound       =&gt; Int32 -2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      | CodeAlreadyExists  =&gt; Int32 -3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      end</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    in</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    { _exception : &quot;Error&quot;; code : result_code }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">contract DemoError()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">field products : Map Uint128 String : Emp Uint128 String</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(* Emit Errors *)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">procedure ThrowError(err : Error)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  e = make_error err;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  throw e</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">end</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">transition AddItem(id: Uint128, name: String)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  product_name &lt;- products[id];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  match product_name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  | Some existing_product =&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (* item already exists; throw error *)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    err = CodeAlreadyExists;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ThrowError err</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  | None =&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (* no existing item; proceed to add to map *)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    products[id] := name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In the above transition <code>AddItem()</code>, it checks if the item already eixsts for the specific id, if so we throw a <code>CodeAlreadyExists</code> error. Otherwise, we add the item into the map.</p><p>Let&#x27;s take a look at how the error is declared and thrown.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(* Error events *)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">type Error =</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| CodeNotOwner</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| CodeNotFound</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| CodeAlreadyExists</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(* Library function that maps Error to a error code *)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">let make_error =</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  fun (result : Error) =&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    let result_code =</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      match result with</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      | CodeNotOwner       =&gt; Int32 -1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      | CodeNotFound       =&gt; Int32 -2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      | CodeAlreadyExists  =&gt; Int32 -3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      end</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    in</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    { _exception : &quot;Error&quot;; code : result_code }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>First, we declare a <strong>Custom ADT</strong> (Custom Abstract Data Type) which is something like a custom object that defines an <code>Error</code> object. Our custom <code>Error</code> object has 3 attributes or definitions that determines what error type we can throw. The error type namings can be any names and has no limits to the number of errors that can be defined.</p><p>Next, we defined a library function <code>make_error</code> which maps our <code>Error</code> types into a <code>Int32</code> number and also outputs the mapping into the form <code>{_exception : &quot;Error&quot;; code : result_code }</code>.</p><p>We can think of this library function like a Javascript JSON, e.g.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    CodeNotOwner : -1,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    CodeNotFound : -2,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    CodeAlreadyExists : -3,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This mapping allow us to compare errors easily and also makes it easier to read in transaction outputs. In the example, we have used a negative number. There isn&#x27;t a strict rule to use a negative number for error codes, positive numbers are also allowed as well.</p><p>Next, we have a procedure <code>ThrowError(err : Error)</code> that takes in our error code, calls our <code>make_error</code> library and throws an exception via the keyword <code>throw</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">procedure ThrowError(err : Error)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  e = make_error err;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  throw e</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Finally, we can invoke this procedure from a transition or another procedure calls by declaring the error type <code>(err = &lt;OurSelfDefinedErrorType&gt;)</code> and calling the <code>ThrowError err</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">transition TestError()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  err = CodeNotFound;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ThrowError err</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>To view the errors output, we can view the transaction state on blockchain explorer such as <a href="https://devex.zilliqa.com" target="_blank" rel="noopener noreferrer"><strong>Devex Zilliqa</strong></a> and <a href="https://viewblock.io/zilliqa" target="_blank" rel="noopener noreferrer"><strong>ViewBlock</strong></a>.</p><p>An example of invoking the transition <code>TesetError</code> looks like this on Devex Zilliqa under &quot;Exceptions&quot; section:</p><p><img alt="Devex Zilliqa Throw Error" src="/zilliqa-tldr-dapp-course/assets/images/errors-9b6db59045b486432b22a5c2d48fabae.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="exercises">Exercises<a aria-hidden="true" class="hash-link" href="#exercises" title="Direct link to heading">â€‹</a></h2><p>The following are some exercises to help you be familiar with events and procedures.</p><p><strong>Instructions</strong></p><ul><li>Download this <a href="https://github.com/teye/zilliqa-tldr-dapp-course/blob/main/exercises/chapter1/ch01_cryptomon_events_errors.scilla" target="_blank" rel="noopener noreferrer"><strong>CryptoMon Contract</strong></a> to get started.</li></ul><br><p><strong>Task 1: Events</strong></p><ul><li>Add checks to <code>AddCryptoMon()</code> such that we only add the new <code>token_id</code> if the <code>token_id</code> is a new entry. <ul><li>After we have added the new <code>token_id</code> into the map, emit an event <code>e = {_eventname: &quot;AddCryptoMon&quot;; token_id: token_id; owner: address}</code></li><li>If the <code>token_id</code> already exists, we do nothing for now.</li></ul></li><li>Add checks to <code>DeleteCryptoMon()</code> such that we only delete the <code>token_id</code> if the <code>token_id</code> exists. <ul><li>After we have deleted the <code>token_id</code> from the map, emit an event <code>e = {_eventname: &quot;DeleteCryptoMon; token_id: token_id&quot;}</code></li><li>If the <code>token_id</code> does not exist, we do nothing for now.</li></ul></li></ul><br><p><strong>Task 2: Errors</strong></p><p>Continuing from the previous tasks, recall that there are some portions of the checks for <code>AddCryptoMon</code> and <code>DeleteCryptoMon</code> which we do nothing? Now, we are going to throw an error for these checks.</p><ul><li>Create a <code>type Error</code> and defined two types: (1) <code>CodeCryptoMonNotExists</code> and (2) <code>CodeCryptoMonAlreadyExists</code>.</li><li>Create the <code>make_error</code> library function and assigned the above codes to a <code>Int32</code> number of your choice.</li><li>Create a <code>ThrowError</code> procedure that takes in the <code>Error</code> type and calls <code>make_error</code> and throw the error exception.</li><li>Edit the transition <code>AddCryptoMon</code> to throw <code>CodeCryptoMonAlreadyExists</code> if we try to add a <code>token_id</code> that already existed in the map.</li><li>Edit the transition <code>DeleteCryptoMon</code> to throw <code>CodeCryptoMonNotExists</code> if we try to delete a <code>token_id</code> that is not present in the map.</li></ul><br><p><strong>Task 3: Testing</strong></p><ul><li>Deploy the contract on  <a href="https://ide.zilliqa.com/" target="_blank" rel="noopener noreferrer"><strong>Neo-Savant IDE</strong></a> on <strong>Simulated Env</strong>.</li><li>Execute <code>AddCryptoMon(1, &lt;your_wallet_address&gt;)</code>.<ul><li>Observe the transaction output.</li><li>The event <code>AddCryptoMon, token_id: 1, owner: &lt;wallet_address&gt;</code> shoud be emitted.</li></ul></li><li>Execute <code>AddCryptoMon(1, &lt;your_wallet_address&gt;)</code> again.<ul><li>Observe the transaction output.</li><li>The error <code>CodeCryptoMonAlreadyExists</code> should be thrown.</li></ul></li><li>Execute <code>DeleteCryptoMon(1)</code>.<ul><li>Observe the transaction output.</li><li>The event <code>DeleteCryptoMon, token_id: 1</code> shoud be emitted.</li></ul></li><li>Execute <code>DeleteCryptoMon(1)</code> again.<ul><li>Observe the transaction output.</li><li>The error <code>CodeCryptoMonNotExists</code> should be thrown.</li></ul></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/teye/zilliqa-tldr-dapp-course/docs/scilla/events_errors.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zilliqa-tldr-dapp-course/docs/scilla/maps"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Maps</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zilliqa-tldr-dapp-course/docs/scilla/custom_adts"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Custom ADT(s)<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#events" class="table-of-contents__link toc-highlight">Events</a></li><li><a href="#errors" class="table-of-contents__link toc-highlight">Errors</a></li><li><a href="#exercises" class="table-of-contents__link toc-highlight">Exercises</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021. Built with Docusaurus.</div></div></div></footer></div>
<script src="/zilliqa-tldr-dapp-course/assets/js/runtime~main.9a777267.js"></script>
<script src="/zilliqa-tldr-dapp-course/assets/js/main.d6dfde11.js"></script>
</body>
</html>