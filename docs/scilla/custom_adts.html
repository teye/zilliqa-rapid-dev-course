<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<title data-react-helmet="true">Custom ADT(s) | TLDR Zilliqa DApp Course</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://teye.github.io/docs/scilla/custom_adts"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Custom ADT(s) | TLDR Zilliqa DApp Course"><meta data-react-helmet="true" name="description" content="Recalled in previous tutorials that Scilla has a map structure in which we can store data in key-value format? The value which we stored so far has been the primitive data types, e.g. ByStr20, Uint128, String .etc."><meta data-react-helmet="true" property="og:description" content="Recalled in previous tutorials that Scilla has a map structure in which we can store data in key-value format? The value which we stored so far has been the primitive data types, e.g. ByStr20, Uint128, String .etc."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://teye.github.io/docs/scilla/custom_adts"><link data-react-helmet="true" rel="alternate" href="https://teye.github.io/docs/scilla/custom_adts" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://teye.github.io/docs/scilla/custom_adts" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.6674abea.css">
<link rel="preload" href="/assets/js/runtime~main.8f778cd9.js" as="script">
<link rel="preload" href="/assets/js/main.642670fc.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://docusaurus.io/" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/hexagon.svg" alt="Site Logo" class="themedImage_TMUO themedImage--light_4Vu1" height="32" width="32"><img src="/img/hexagon_light.svg" alt="Site Logo" class="themedImage_TMUO themedImage--dark_uzRr" height="32" width="32"></div><b class="navbar__title">Home</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Developing DApp on Zilliqa</a></div><div class="navbar__items navbar__items--right"><div class="toggle_iYfV toggle_2i4l toggleChecked_a04y toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" checked="" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Start Here</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Chapter 1: Sciila</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scilla/intro">Scilla Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scilla/transitions_procedures">Transitions &amp; Procedures</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scilla/maps">Maps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scilla/events_errors">Events &amp; Errors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/scilla/custom_adts">Custom ADT(s)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scilla/remote_state_reads">Remote State Reads</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Chapter 2: Zilliqa API &amp; ZilliqaJS</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Chapter 3: React DApp Development</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Custom ADT(s)</h1></header><p>Recalled in previous tutorials that Scilla has a map structure in which we can store data in key-value format? The value which we stored so far has been the primitive data types, e.g. <code>ByStr20</code>, <code>Uint128</code>, <code>String</code> .etc. </p><p>What if we want to store a more complex value such as an object? </p><p>This is where custom ADT short for <em>Algebraic Datatype</em>. An <strong>ADT</strong> is a <strong>user-defined</strong> object that contains other primitive types.</p><p>See <a href="https://scilla.readthedocs.io/en/latest/scilla-in-depth.html#algebraic-datatypes" target="_blank" rel="noopener noreferrer">https://scilla.readthedocs.io/en/latest/scilla-in-depth.html#algebraic-datatypes</a> for more details.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="declaration">Declaration<a aria-hidden="true" class="hash-link" href="#declaration" title="Direct link to heading">â€‹</a></h2><p>An ADT is defined after the <code>library</code> keyword and before the <code>contract</code> declarations.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">scilla_version 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">library MyContract</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(* user defined ADT *)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(* owner, unit_no, size  *)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">type House =</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| House of ByStr20 Uint128 Uint128 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(***************************************************)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(*             The contract definition             *)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(***************************************************)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">contract MyContract</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    owner: ByStr20</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(* mutable fields declarations *)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(* house_id -&gt; House details *)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">field houses_for_sales: Map Uint256 House = Emp Uint256 House</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(* procedures declarations *)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(* transitions declarations *)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In the above example, we declared a custom type <code>House</code> after the library declaration but before the contract definition. </p><p>The <code>House</code> type consists of 3 primitive types: <code>ByStr20 Uint128 Uint128</code> to record the owner address, unit number and capacity. </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">field houses_for_sales: Map Uint256 House = Emp Uint256 House</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This <code>House</code> type is later declared in a map under <code>houses_for_sales</code>. With these two examples, we can observe how to declare a custom ADT and also how to use it.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="syntax">Syntax<a aria-hidden="true" class="hash-link" href="#syntax" title="Direct link to heading">â€‹</a></h4><p>To put it more formally, an ADT declaration looks like this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">type CUSTOM_ADT_NAME =</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| CUSTOM_ADT_NAME of &lt;Type1&gt; &lt;Type2&gt; .... &lt;TypeK&gt; </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>A custom ADT can have unlimited types <code>&lt;TypeX&gt;</code> and identical types are allowed.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="utilizing-custom-adt-in-transitions">Utilizing Custom ADT in Transitions<a aria-hidden="true" class="hash-link" href="#utilizing-custom-adt-in-transitions" title="Direct link to heading">â€‹</a></h4><p>Now that we&#x27;ve learnt how to declare and use ADTs in maps, we need to know how to create the ADT and assign it to the maps. To create the ADT, we simply call the ADT name and filled in the <code>Type</code> to the ADT.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">transition AddHouse(house_id: Uint256, owner: ByStr20, unit: Uint128, capacity: Uint128)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  new_house = House owner unit capacity;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  houses_for_sale[house_id] := new_house</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In the above <code>AddHouse()</code> transition, the transition takes in <code>house_id</code>, <code>owner</code>, <code>unit</code> and <code>capacity</code>. </p><p>Next, the transition creates the custom ADT <code>House</code> using some of the input parameters.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">new_house = House owner unit capacity;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>When we create the custom ADT object, we must filled up all the required <code>Types</code> as defined by us.</p><p>Finally, the new object is stored into the <code>houses_for_sale</code> map.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">houses_for_sale[house_id] := new_house</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="exercises">Exercises<a aria-hidden="true" class="hash-link" href="#exercises" title="Direct link to heading">â€‹</a></h2><p>The following are some exercises to help you be familiar with ADTs.</p><p><strong>Instructions</strong></p><ul><li>Download this <a href="https://github.com/teye/zilliqa-tldr-dapp-course/blob/main/exercises/chapter1/ch01_cryptomon_custom_adts.scilla" target="_blank" rel="noopener noreferrer"><strong>CryptoMon Contract</strong></a> to get started.</li></ul><br><p><strong>Task 1</strong>
Define a custom ADT <code>Cryptomon</code>. This ADT should keep track of the Cryptomon name in <code>String</code>, age in <code>Uint128</code>, height in <code>Uint128</code> and level in <code>Uint128</code>.</p><p><strong>Task 2</strong></p><ul><li>After declaring the new ADT, define a map called <code>cryptomons</code> which takes the cryptomon id in <code>Uint256</code> and map it to the <code>Cryptomon</code> ADT from Task 1, i.e. (<code>Uint256</code> -&gt; <code>Cryptomon</code>).</li><li>Define a new transition <code>AddCryptoMon</code> that takes in <code>cryptomon_id</code>, <code>name</code>, <code>age</code>, <code>height</code> and <code>level</code> and add the new entry into the <code>cryptomons</code> map.</li><li>Define a new transition <code>DeleteCryptoMon</code> that deletes the specific <code>cryptomon_id</code> from <code>cryptomons</code>.</li></ul><p><strong>Task 3</strong></p><ul><li>Deploy the contract on  <a href="https://ide.zilliqa.com/" target="_blank" rel="noopener noreferrer"><strong>Neo-Savant IDE</strong></a> on <strong>Simulated Env</strong>.</li><li>Execute <code>AddCryptoMon(1, GetRichMon, 500, 12, 10)</code>.</li><li>Execute <code>AddCryptoMon(2, WhaleMon, 750, 50, 100)</code>.</li><li>Execute <code>DeleteCryptoMon(1)</code>.</li><li>Look at the deployed contract state on <strong>ViewBlock</strong>.</li></ul><p>The final contract state should look something like this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI json"><pre tabindex="0" class="prism-code language-json codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cryptomons </span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;2&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;argtypes&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token property">&quot;arguments&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;WhaleMon&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;750&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">       </span><span class="token comment" style="color:rgb(98, 114, 164)">// age</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;50&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">// height</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;100&quot;</span><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">// level</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/teye/zilliqa-tldr-dapp-course/docs/scilla/custom_adts.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/scilla/events_errors"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Events &amp; Errors</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/scilla/remote_state_reads"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Remote State Reads<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#declaration" class="table-of-contents__link toc-highlight">Declaration</a></li><li><a href="#exercises" class="table-of-contents__link toc-highlight">Exercises</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.8f778cd9.js"></script>
<script src="/assets/js/main.642670fc.js"></script>
</body>
</html>